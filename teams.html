<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>æ‰¹é‡å¯¼å…¥ç»„é˜Ÿæ•°æ®</title>
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-4.13.3.js"></script>
  <style>
    body {
      font-family: "Microsoft YaHei", sans-serif;
      background: #f0f4f8;
      padding: 30px;
      color: #2c3e50;
    }
    .container {
      max-width: 700px;
      margin: 0 auto;
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #1a237e;
    }
    button {
      display: block;
      width: 200px;
      margin: 20px auto;
      padding: 12px;
      background: #3f51b5;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background: #303f9f;
    }
    button:disabled {
      background: #bdbdbd;
      cursor: not-allowed;
    }
    .log {
      background: #f8f9fa;
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 15px;
      height: 200px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 14px;
      margin-top: 20px;
    }
    .status {
      text-align: center;
      margin-top: 15px;
      font-weight: bold;
      min-height: 24px;
    }
    .success { color: #2e7d32; }
    .error { color: #c62828; }
  </style>
</head>
<body>

<div class="container">
  <h1>æ‰¹é‡å¯¼å…¥ 45 åå­¦ç”Ÿåˆ° TeamAssignment</h1>
  <button id="importBtn">å¼€å§‹å¯¼å…¥</button>
  <div class="status" id="status"></div>
  <div class="log" id="log"></div>
</div>

<script>
  // ===== CONFIGURATION =====
  const APP_ID = 'bRduy3DbzwQxOlAUaTNRwR9h-gzGzoHsz';
  const APP_KEY = 'aO1ScYpA3p4XWR50nnPcgixQ';

  // Student data as array of objects
  const STUDENT_DATA = [
    { studentname: "ç”°é›ª", teamnumber: 1, slotnumber: 1 },
    { studentname: "èƒ¡é›…æ¶µ", teamnumber: 1, slotnumber: 2 },
    { studentname: "èŒƒæ€é¢–", teamnumber: 2, slotnumber: 1 },
    { studentname: "åˆ˜å°æ½", teamnumber: 2, slotnumber: 2 },
    { studentname: "ææ¬£éœ–", teamnumber: 3, slotnumber: 1 },
    { studentname: "æå”¯æ€¡", teamnumber: 3, slotnumber: 2 },
    { studentname: "ä½•é›¨ç†¹", teamnumber: 4, slotnumber: 1 },
    { studentname: "ç½—ç†™ç³", teamnumber: 4, slotnumber: 2 },
    { studentname: "å´å¯æ¶µ", teamnumber: 5, slotnumber: 1 },
    { studentname: "ä½•è‰¾éœ–", teamnumber: 5, slotnumber: 2 },
    { studentname: "å´è¹è¹", teamnumber: 6, slotnumber: 1 },
    { studentname: "äºé™é›¯", teamnumber: 6, slotnumber: 2 },
    { studentname: "å½­æ¡¢èŒ—", teamnumber: 7, slotnumber: 1 },
    { studentname: "æŸ¯æŸå®‡", teamnumber: 7, slotnumber: 2 },
    { studentname: "èµµå½¦æ°", teamnumber: 8, slotnumber: 1 },
    { studentname: "ä¸æ³Šæ–‡", teamnumber: 8, slotnumber: 2 },
    { studentname: "è‚–å–ƒå…", teamnumber: 9, slotnumber: 1 },
    { studentname: "å¼ é’°ç¿", teamnumber: 9, slotnumber: 2 },
    { studentname: "å”æ€è¯º", teamnumber: 10, slotnumber: 1 },
    { studentname: "ä½™å®œè²", teamnumber: 10, slotnumber: 2 },
    { studentname: "éƒ‘è¡Œ", teamnumber: 11, slotnumber: 1 },
    { studentname: "é™¶é›¨æœ", teamnumber: 11, slotnumber: 2 },
    { studentname: "æè™¹é¢–", teamnumber: 12, slotnumber: 1 },
    { studentname: "ä½•é›¨ç¿", teamnumber: 12, slotnumber: 2 },
    { studentname: "å†¯ç³å¨Ÿ", teamnumber: 13, slotnumber: 1 },
    { studentname: "ææµ·éŸµ", teamnumber: 13, slotnumber: 2 },
    { studentname: "é‡‘å¿—æ™–", teamnumber: 14, slotnumber: 1 },
    { studentname: "æŸ¯æŸå»·", teamnumber: 14, slotnumber: 2 },
    { studentname: "å‘¨æœ•å®‡", teamnumber: 15, slotnumber: 1 },
    { studentname: "å”æ™å°§", teamnumber: 15, slotnumber: 2 },
    { studentname: "æä¹¦è¡Œ", teamnumber: 16, slotnumber: 1 },
    { studentname: "é™ˆå®‰è¾¾", teamnumber: 16, slotnumber: 2 },
    { studentname: "ä»»æŸ¯å˜‰", teamnumber: 17, slotnumber: 1 },
    { studentname: "åˆ˜é˜³ç¿", teamnumber: 17, slotnumber: 2 },
    { studentname: "æå¿—æµ©", teamnumber: 18, slotnumber: 1 },
    { studentname: "é™ˆæ€¡è¯ºï¼ˆç”·ï¼‰", teamnumber: 18, slotnumber: 2 },
    { studentname: "ç‹é“„", teamnumber: 19, slotnumber: 1 },
    { studentname: "å†¯å˜‰ç†™", teamnumber: 19, slotnumber: 2 },
    { studentname: "è®¸æ¬£ä»ª", teamnumber: 20, slotnumber: 1 },
    { studentname: "ææ²‚è”“", teamnumber: 20, slotnumber: 2 },
    { studentname: "æ–¹å°ç¿", teamnumber: 21, slotnumber: 1 },
    { studentname: "ç½—é’°æ·‡", teamnumber: 21, slotnumber: 2 },
    { studentname: "åˆ˜å­ç¦", teamnumber: 22, slotnumber: 1 },
    { studentname: "é™ˆæ€¡è¯ºï¼ˆå¥³ï¼‰", teamnumber: 22, slotnumber: 2 },
    { studentname: "å´éƒ‘é˜³", teamnumber: 23, slotnumber: 1 },
    { studentname: "æ˜“æ˜Ÿè¾°", teamnumber: 23, slotnumber: 2 },
    { studentname: "æ®·å°ä¸", teamnumber: 24, slotnumber: 1 }
  ];

  // DOM elements
  const btn = document.getElementById('importBtn');
  const statusEl = document.getElementById('status');
  const logEl = document.getElementById('log');

  function log(msg) {
    const line = document.createElement('div');
    line.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
    logEl.appendChild(line);
    logEl.scrollTop = logEl.scrollHeight;
  }

  async function importData() {
    try {
      AV.init({ appId: APP_ID, appKey: APP_KEY });
      log(`åˆå§‹åŒ– LeanCloud SDK...`);

      btn.disabled = true;
      statusEl.textContent = 'æ­£åœ¨å¯¼å…¥...';
      statusEl.className = '';

      const total = STUDENT_DATA.length;
      let successCount = 0;

      for (let i = 0; i < total; i++) {
        const record = STUDENT_DATA[i];
        const obj = new AV.Object('TeamAssignment');
        obj.set('studentname', record.studentname);
        obj.set('teamnumber', record.teamnumber);
        obj.set('slotnumber', record.slotnumber);

        try {
          await obj.save();
          successCount++;
          log(`âœ… [${i+1}/${total}] å·²ä¿å­˜: ${record.studentname} â†’ ç»„${record.teamnumber}-${record.slotnumber}`);
        } catch (err) {
          log(`âŒ [${i+1}/${total}] å¤±è´¥ (${record.studentname}): ${err.message}`);
          console.error('Save error:', err);
        }
      }

      if (successCount === total) {
        statusEl.textContent = `ğŸ‰ å…¨éƒ¨ ${total} æ¡è®°å½•å¯¼å…¥æˆåŠŸï¼`;
        statusEl.className = 'success';
      } else {
        statusEl.textContent = `âš ï¸ å®Œæˆ: ${successCount}/${total} æˆåŠŸï¼Œå…¶ä½™å¤±è´¥ï¼ˆè§æ—¥å¿—ï¼‰`;
        statusEl.className = 'error';
      }
    } catch (err) {
      log(`ğŸ’¥ åˆå§‹åŒ–å¤±è´¥: ${err.message}`);
      statusEl.textContent = `âŒ åˆå§‹åŒ–å¤±è´¥: ${err.message}`;
      statusEl.className = 'error';
    } finally {
      btn.disabled = false;
    }
  }

  btn.addEventListener('click', importData);
</script>

</body>
</html>
